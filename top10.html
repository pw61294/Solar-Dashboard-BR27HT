<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Top 10 Solar Production Days</title>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
<style>
  body {
    font-family: Arial, sans-serif;
    background: #232832;
    margin: 0;
    padding: 0;
    transition: background 0.3s, color 0.3s;
    color: #e0e0e0;
  }

  header {
    background: #16181d;
    color: #fff;
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .header-left {
    display: flex;
    flex-direction: column;
    gap: 5px;
  }

  .header-left a {
    color: white;
    text-decoration: none;
    font-size: 1em;
    padding: 2px 0;
  }

  .header-title {
    flex-grow: 1;
    text-align: center;
  }

  main {
    max-width: 1000px;
    margin: auto;
    padding: 20px;
  }

  table {
    background: #16181d;
    border-radius: 10px;
    overflow: hidden;
    margin-top: 20px;
  }

  canvas {
    background: #16181d;
    border-radius: 10px;
    padding: 15px;
  }
</style>
</head>
<body>
<header>
  <div class="header-left">
    <a href="index.html">üè† Dashboard</a>
    <a href="top10.html">üèÜ Top 10</a>
    <a href="monthly.html">üìÖ Monthly</a>
    <a href="peakwatts.html">‚ö° Peak Watts</a>
  </div>
  <div class="header-title">
    <h2>üèÜ Top 10 Solar Production Days</h2>
  </div>
</header>

<main>
  <div style="height:500px;">
    <canvas id="top10Chart"></canvas>
  </div>

  <table id="top10Table" class="display stripe hover" style="width:100%">
    <thead>
      <tr>
        <th>Date</th>
        <th>Generated (kWh)</th>
        <th>Exported (kWh)</th>
        <th>Peak Watts</th>
        <th>Peak Time</th>
        <th>Weather</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</main>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
<script>
const rawData = `
20250702,291,0,577,18:37,Cloudy
20250703,33626,15500,4853,13:29,Partly Cloudy
20250704,35737,14900,5415,13:32,Partly Cloudy
20250705,18870,8100,4463,13:38,Rainy
20250706,20006,4200,5044,12:31,Partly Cloudy
20250707,25658,7400,5989,14:02,Partly Cloudy
20250708,37780,17800,5372,11:11,Sunny
20250709,34654,13200,5962,13:30,Partly Cloudy
20250710,36394,16200,4359,12:26,Partly Cloudy
20250711,36446,14400,4244,11:34,Partly Cloudy
20250712,36147,12800,4300,11:30,Partly Cloudy
20250713,28394,3300,4901,14:12,Partly Cloudy
20250714,33121,11000,5641,12:41,Partly Cloudy
20250715,31809,9900,5453,12:13,Partly Cloudy
20250716,35773,8100,5685,12:28,Partly Cloudy
20250717,17364,6700,4615,10:49,Rainy
20250718,32937,10800,5583,11:20,Partly Cloudy
20250719,11048,1800,4861,14:52,Cloudy
20250720,20234,13200,5314,14:50,Partly Cloudy
20250721,27296,12500,5681,11:18,Partly Cloudy
20250722,21117,6400,6101,11:27,Cloudy
20250723,16972,6900,3755,09:59,Rainy
20250724,12494,3900,3593,11:25,Cloudy
20250725,30961,19600,4888,12:26,Partly Cloudy
20250726,20433,8300,4595,15:31,Partly Cloudy
20250727,18261,13400,5018,13:52,Cloudy
20250728,33654,14800,5881,14:07,Partly Cloudy
20250729,15511,200,4001,12:44,Rainy
20250730,19034,7700,5185,11:11,Cloudy
20250731,13691,100,5251,13:13,Cloudy
20250801,20828,5600,5534,12:02,Cloudy
20250802,21967,7400,4393,10:34,Cloudy
20250803,23685,5700,4973,10:53,Cloudy
20250804,15341,100,2885,12:10,Cloudy
20250805,30710,12800,5197,13:30,Partly Cloudy
20250806,37308,26100,4761,13:27,Partly Cloudy
20250807,23584,9400,5443,12:26,Partly Cloudy
20250808,33645,22500,5241,14:17,Partly Cloudy
20250809,42103,14200,8600,13:09,Sunny
20250810,54640,30800,7734,13:04,Sunny
20250811,53647,31200,6829,11:52,Sunny
20250812,52670,29600,6749,12:25,Sunny
20250813,22965,200,5985,14:44,Cloudy
20250814,35556,17900,8080,13:35,Partly Cloudy
20250815,50293,20900,6776,12:12,Sunny
20250816,10421,2000,1867,13:52,Cloudy
20250817,52312,21700,6934,12:01,Sunny
20250818,16978,5200,5236,11:06,Cloudy
20250819,33255,8500,6981,11:19,Partly Cloudy
20250820,24105,9100,7561,14:00,Cloudy
20250821,19737,1900,4294,14:28,Cloudy
20250822,39243,6300,7823,11:15,Partly Cloudy
20250823,28462,7400,8155,13:11,Partly Cloudy
20250824,44424,14400,7928,13:15,Sunny
20250825,51219,15900,6685,12:05,Sunny
20250826,31960,7300,7602,13:50,Partly Cloudy
20250827,31190,15400,8274,12:01,Partly Cloudy
20250828,37594,10300,8779,11:40,Partly Cloudy
20250829,23434,9800,8431,14:13,Cloudy
20250830,32720,9700,8664,13:51,Partly Cloudy
20250831,39794,18600,8793,11:51,Partly Cloudy
20250901,37828,7100,7897,11:49,Partly Cloudy
20250902,26021,8000,9948,13:02,Partly Cloudy
20250903,19196,3400,7622,11:11,Cloudy
20250904,30399,4200,8263,12:25,Partly Cloudy
20250905,38156,3600,7647,12:31,Partly Cloudy
20250906,39170,5900,8542,12:34,Partly Cloudy
20250907,38121,10300,7493,12:15,Partly Cloudy
20250908,42680,7100,7594,11:31,Partly Cloudy
20250909,41082,6900,7760,12:01,Partly Cloudy
20250910,21978,7900,8907,13:15,Cloudy
20250911,30443,2500,7311,13:16,Partly Cloudy
20250912,35188,3700,8084,13:02,Partly Cloudy
20250913,31342,6300,8660,12:39,Partly Cloudy
20250914,15416,1300,3591,11:16,Rainy
20250915,34870,6300,8254,11:45,Partly Cloudy
20250916,34566,4700,8269,11:56,Partly Cloudy
20250917,8607,1000,5663,12:43,Cloudy
20250918,17912,8500,7702,14:05,Cloudy
20250919,41673,27200,6249,11:42,Partly Cloudy
20250920,15151,5800,6916,12:16,Cloudy
20250921,28457,14000,8280,11:44,Cloudy
20250922,38539,21200,7320,12:17,Partly Cloudy
20250923,23098,6300,8482,11:53,Cloudy
20250924,28577,16900,7773,11:34,Cloudy
20250925,39389,20300,7319,11:35,Partly Cloudy
20250926,8124,2000,2533,13:25,Cloudy
20250927,23002,5200,6837,13:21,Partly Cloudy
20250928,8080,700,2365,08:48,Cloudy
20250929,30965,17100,6295,12:35,Partly Cloudy
20250930,36734,16700,5903,11:54,Sunny
`;


const weatherEmoji = {
  "Sunny": "‚òÄÔ∏è Sunny",
  "Cloudy": "‚òÅÔ∏è Cloudy",
  "Partly Cloudy": "‚õÖ Partly Cloudy",
  "Rainy": "üåßÔ∏è Rainy"
};

$(document).ready(function(){
  const dataRows = rawData.trim().split("\n").map(r => r.split(",")).map(r => ({
    date: `${r[0].slice(0,4)}-${r[0].slice(4,6)}-${r[0].slice(6,8)}`,
    generated: Number(r[1])/1000,
    exported: Number(r[2])/1000,
    peak: Number(r[3]),
    time: r[4],
    weather: r[5]
  }));

  const top10 = dataRows.sort((a,b)=>b.generated-a.generated).slice(0,10);

  top10.forEach(r => {
    $('#top10Table tbody').append(`
      <tr>
        <td>${r.date}</td>
        <td>${r.generated.toFixed(2)}</td>
        <td>${r.exported.toFixed(2)}</td>
        <td>${r.peak.toLocaleString()}</td>
        <td>${r.time}</td>
        <td>${weatherEmoji[r.weather] || r.weather}</td>
      </tr>
    `);
  });

  $('#top10Table').DataTable({ order: [[1,'desc']], stripeClasses:['odd','even'] });

  const ctx = document.getElementById("top10Chart").getContext('2d');
  const barColor = '#232832';

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: top10.map(r=>r.date),
      datasets:[{
        label:'Generated (kWh)',
        data: top10.map(r=>r.generated),
        backgroundColor: barColor,
        borderRadius: 8,
        borderWidth:1,
        hoverBackgroundColor: '#2e3440'
      }]
    },
    options:{
      responsive:true,
      maintainAspectRatio:false,
      plugins:{
        legend:{ labels:{ color:'#eee', font:{ size:16 } } },
        title:{ display:true, text:'Top 10 Best Production Days', color:'#eee', font:{ size:20 } },
        datalabels:{
          anchor:'end',
          align:'end',
          color:'#eee',
          font:{ size:14, weight:'bold' },
          formatter: v => v.toFixed(2)+' kWh'
        }
      },
      scales:{
        x:{ ticks:{ color:'#eee', font:{ size:14 } } },
        y:{ ticks:{ color:'#eee', font:{ size:14 } } }
      }
    },
    plugins:[ChartDataLabels]
  });
});
</script>
</body>
</html>
